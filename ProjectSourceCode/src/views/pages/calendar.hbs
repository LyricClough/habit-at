{{> head}}

{{#unless hideNav}}
  {{> nav}}
{{/unless}}

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap JS (Bundle includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>

<div class="container">
  <!-- Calendar Header -->
  <div class="row mt-4">
    <h1 class="col">Your Habit Calendar</h1>
    <button id="add-habit-btn" class="btn btn-primary">Add Habit</button>
  </div>

<!-- Add Habit Modal -->
<div class="modal fade" id="habitModal" tabindex="-1" aria-labelledby="habitModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="habit-form">
        <div class="modal-header">
          <h5 class="modal-title" id="habitModalLabel">Add New Habit</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="habitName" class="form-label">Habit Name</label>
            <input type="text" class="form-control" id="habitName" required>
          </div>
          <div class="mb-3">
            <label for="habitDescription" class="form-label">Description</label>
            <textarea class="form-control" id="habitDescription" rows="2"></textarea>
          </div>
          <div class="mb-3">
            <label for="habitWeekday" class="form-label">Weekday</label>
            <select class="form-select" id="habitWeekday" required>
              <option value="" disabled selected>Select a day</option>
              <option value="0">Sunday</option>
              <option value="1">Monday</option>
              <option value="2">Tuesday</option>
              <option value="3">Wednesday</option>
              <option value="4">Thursday</option>
              <option value="5">Friday</option>
              <option value="6">Saturday</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="habitTime" class="form-label">Hour (0â€“23)</label>
            <input type="number" class="form-control" id="habitTime" min="0" max="23" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Save Habit</button>
        </div>
      </form>
    </div>
  </div>
</div>


  <!-- Calendar Table -->
  <table class="table table-bordered mt-4">
    <thead>
      <tr>
        <th>Time</th>
        {{#each weekdays}}
          <th>{{this}}</th>
        {{/each}}
      </tr>
    </thead>
    <tbody>
      {{#each calendarData}}
        <tr>
          <td>{{@index}}</td> <!-- Hour (row index) -->
          {{#each this}}
            <td>
              {{#if this}}
                <!-- Display habit info if available -->
                <p>{{this.habit_name}}</p>
                <p>{{this.description}}</p>
              {{else}}
                <!-- Empty cell if no habit -->
                <p>No Habit</p>
              {{/if}}
            </td>
          {{/each}}
        </tr>
      {{/each}}
    </tbody>
  </table>
</div>

<script src="/resources/js/calendar.js" defer></script>

{{> footer}}
